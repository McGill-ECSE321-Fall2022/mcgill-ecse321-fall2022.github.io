=== The Domain Mode

Our task is to build an event registration application that allows people to register for events. Before we can program anything we need to model the application. 

First, create a gradle project  following the steps given in *Section 1.1*. Your project structure should look like this.

[source,none]
----
EventRegistration-Backend
├── build.gradle
├── settings.gradle
└── src
    ├── main
    │   ├── java
    │   │   └── ca\mcgill\ecse321\eventregistration
    │   │        └── EventRegistrationApplication.java
    │   └── resources
    │       └── application.settings
    │
    └── test
        └── java
            └── ca\mcgill\ecse321\eventregistration
                └── EventRegistrationApplicationTests
----

For this, use the free modelling program link:https://cruise.umple.org/umpleonline/[Umple]. Full documentation on how to use Umple can be found link:https://cruise.umple.org/umple/GettingStarted.html[here].

Ensure that Umple is configured as shown in the image below:

image::figs/UmpleConfig.png[]

Our task for this tutorial will be to create a simple event registration application that allows people to sign up and register for events. 

The final model can be found below and is generated by the following code:

image::figs/DomainModel.PNG[]

[source,Umple]
----
class RegistrationManager
{
}

class Person
{
  name;
}

class Event
{
  name;
  Date eventDate;
  Time startTime;
  Time endTime;
}

class Registration
{
  Integer id;
  }

association {
    1 RegistrationManager registrationManager <@>- 0..* Registration registrations;
}

association {
    1 RegistrationManager registrationManager <@>- 0..* Event events;
}

association {
    1 RegistrationManager registrationManager <@>- 0..* Person persons;
}

association {
   0..* Registration registration ->  1 Event event ;
}


association {
    0..* Registration registration ->  1 Person person;
}
----

Although the Umple generated Java code can be used, but is too verbose and not JPA compliant. You can see this by comparing the generated Java code to the code found in link:https://github.com/McGill-ECSE321-Fall2020/ecse321-tutorial-notes/raw/master/resources/Model%20Classes.zip[Model Classes.zip].

This is an exercise in being able to write JPA compliant code simply by looking at the domain model. A brief explanation for relevant JPA tags is here provided:

* *@Entity*: Placed before the class declaration to signify an entity.
* *@Id*: Placed before the get method for the attribute that will serve as the primary identifier for the class.
* *@OnetoMany* or *@ManytoOne*: Placed before get method for attribute to signify the multiplicity in associative relationship between the current class and reference class. The first word is the multiplicity of the current class, with the other representing the multiplicity of the other calss. The _cascade_ property being set to _cascadeType.ALL_ ensures all operations of the defining class are persisted. The _optional_ property being set to false means the association the tag defines must exist. In this case, the defining class cannot exist without knowledge of the referenced class. 

Once your java code has been annotated, create a new folder under _src>main>java_ called model and add the model files into that folder. Each class in our domain model should have its own file. Make sure your model files declare the package:

[source,java]
----
package ca.mcgill.ecse321.eventregistration.model;
----

Your folder structure should now look like this:

[source,none]
----
EventRegistration-Backend
├── build.gradle
├── settings.gradle
└── src
    ├── main
    │   ├── java
    │   │   └── ca\mcgill\ecse321\eventregistration
    │   │        ├── EventRegistrationApplication.java
    │   │        └── model
    │   │            ├── Event.java
    │   │            ├── Person.java
    │   │            ├── Registration.java
    │   │            └── RegistrationManager.java
    │   └── resources
    │       └── application.settings
    │
    └── test
        └── java
            └── ca\mcgill\ecse321\eventregistration
                └── EventRegistrationApplicationTests
----
